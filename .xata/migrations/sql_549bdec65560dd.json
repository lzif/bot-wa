{
  "done": true,
  "migration": {
    "name": "sql_549bdec65560dd",
    "operations": [
      {
        "sql": {
          "up": "CREATE TABLE whatsmeow_device (jid text PRIMARY KEY, lid text, facebook_uuid uuid, registration_id bigint NOT NULL CHECK (registration_id >= 0 AND registration_id < 4294967296), noise_key bytea NOT NULL CHECK (length(noise_key) = 32), identity_key bytea NOT NULL CHECK (length(identity_key) = 32), signed_pre_key bytea NOT NULL CHECK (length(signed_pre_key) = 32), signed_pre_key_id int NOT NULL CHECK (signed_pre_key_id >= 0 AND signed_pre_key_id < 16777216), signed_pre_key_sig bytea NOT NULL CHECK (length(signed_pre_key_sig) = 64), adv_key bytea NOT NULL, adv_details bytea NOT NULL, adv_account_sig bytea NOT NULL CHECK (length(adv_account_sig) = 64), adv_account_sig_key bytea NOT NULL CHECK (length(adv_account_sig_key) = 32), adv_device_sig bytea NOT NULL CHECK (length(adv_device_sig) = 64), platform text NOT NULL DEFAULT '', business_name text NOT NULL DEFAULT '', push_name text NOT NULL DEFAULT '', lid_migration_ts bigint NOT NULL DEFAULT 0); CREATE TABLE whatsmeow_identity_keys (our_jid text, their_id text, identity bytea NOT NULL CHECK (length(identity) = 32), PRIMARY KEY (our_jid, their_id), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_pre_keys (jid text, key_id int CHECK (key_id >= 0 AND key_id < 16777216), key bytea NOT NULL CHECK (length(key) = 32), uploaded boolean NOT NULL, PRIMARY KEY (jid, key_id), FOREIGN KEY (jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_sessions (our_jid text, their_id text, session bytea, PRIMARY KEY (our_jid, their_id), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_sender_keys (our_jid text, chat_id text, sender_id text, sender_key bytea NOT NULL, PRIMARY KEY (our_jid, chat_id, sender_id), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_app_state_sync_keys (jid text, key_id bytea, key_data bytea NOT NULL, \"timestamp\" bigint NOT NULL, fingerprint bytea NOT NULL, PRIMARY KEY (jid, key_id), FOREIGN KEY (jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_app_state_version (jid text, name text, version bigint NOT NULL, hash bytea NOT NULL CHECK (length(hash) = 128), PRIMARY KEY (jid, name), FOREIGN KEY (jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_app_state_mutation_macs (jid text, name text, version bigint, index_mac bytea CHECK (length(index_mac) = 32), value_mac bytea NOT NULL CHECK (length(value_mac) = 32), PRIMARY KEY (jid, name, version, index_mac), FOREIGN KEY (jid, name) REFERENCES whatsmeow_app_state_version (jid, name) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_contacts (our_jid text, their_jid text, first_name text, full_name text, push_name text, business_name text, redacted_phone text, PRIMARY KEY (our_jid, their_jid), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_chat_settings (our_jid text, chat_jid text, muted_until bigint NOT NULL DEFAULT 0, pinned boolean NOT NULL DEFAULT false, archived boolean NOT NULL DEFAULT false, PRIMARY KEY (our_jid, chat_jid), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_message_secrets (our_jid text, chat_jid text, sender_jid text, message_id text, key bytea NOT NULL, PRIMARY KEY (our_jid, chat_jid, sender_jid, message_id), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE); CREATE TABLE whatsmeow_privacy_tokens (our_jid text, their_jid text, token bytea NOT NULL, \"timestamp\" bigint NOT NULL, PRIMARY KEY (our_jid, their_jid)); CREATE TABLE whatsmeow_lid_map (lid text PRIMARY KEY, pn text UNIQUE NOT NULL); CREATE TABLE whatsmeow_event_buffer (our_jid text NOT NULL, ciphertext_hash bytea NOT NULL CHECK (length(ciphertext_hash) = 32), plaintext bytea, server_timestamp bigint NOT NULL, insert_timestamp bigint NOT NULL, PRIMARY KEY (our_jid, ciphertext_hash), FOREIGN KEY (our_jid) REFERENCES whatsmeow_device (jid) ON UPDATE CASCADE ON DELETE CASCADE)"
        }
      }
    ]
  },
  "migrationType": "inferred",
  "name": "sql_549bdec65560dd",
  "parent": "sql_4ace829ff454c3",
  "schema": "public",
  "startedAt": "2025-10-31T13:06:50.499028Z"
}
